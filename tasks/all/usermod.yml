---
- name: "Common Install zsh (Ubuntu)"
  ansible.builtin.apt:
    name: "zsh"
    state: present
  when: ansible_distribution == "Ubuntu"

- name: "Common / Usermod (Ubuntu)"
  ansible.builtin.user:
    name: "{{ item.username }}"
    shell: "{{ item.shell }}"
    state: "present"
    system: true
    uid: "{{ item.uid }}"
  loop: "{{ all.vars.user }}"
  no_log: true
  when: ansible_distribution == "Ubuntu"

- name: "Common / Usermod (macOS)"
  ansible.builtin.user:
    name: "{{ item.username }}"
    shell: "{{ item.shell_mac }}"
    state: "present"
    system: true
    uid: "{{ item.uid }}"
  loop: "{{ all.vars.user }}"
  no_log: true
  when: ansible_distribution == "MacOSX"
