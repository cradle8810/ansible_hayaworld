---
- name: Install Macbook brew
  community.general.homebrew:
    name: "{{ brew.apps }}"
    state: upgraded
    update_homebrew: true
  register: brew_rc

- name: Show Installed/Updated brew packages
  ansible.builtin.debug:
    var: brew_rc.changed_pkgs

- name: Restart services if needs
  community.general.homebrew_services:
    name: "{{ brew_rc.changed_pkgs }}"
    state: restarted
  when: "( brew_rc.changed_pkgs | length > 0 ) and ( brew.service is defined )"
